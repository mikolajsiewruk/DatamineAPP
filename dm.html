<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
<HEAD>
<style>
    body {
        background-color: rgb(237, 255, 239);
        font-family: Calibri;
    }
    #btnExecute,#btnHelp {
      width: 90px;
      background-color: rgb(237, 255, 239);
      color: black;
      border: 2px solid green;
      padding: 10px 20px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
        font-weight: bold;
    }
    #help{
        color: rgb(237, 255, 239);
    }
</style>
<META Name="DatamineScript" Content="Version3" charset = "UTF-8" />
<TITLE>Command Automatically recorded html script.</TITLE>
<SCRIPT TYPE="text/javascript">

// ----------------------------------------------------------------------
// Standard initialisation for Datamine Studio 3
//
var oDmApp= null;
var oScript = null;
var a = 0
function AutoConnect()
{
   try {
      oScript = new ActiveXObject("StudioCommon.ScriptHelper");
      oScript.initialize(window);
      oDmApp = oScript.getApplication();
      if (oDmApp == null || oDmApp.ActiveProject == null)    //Attempt to Use the Active Datamine Session
      {
         alert("There are no active projects open.\n Please open a project before continuing.");
         window.close();                                                     // Closes the script window
	 return false;
      }
      else
      {
         document.getElementById("logo").src = oDmApp.Options.HtmlFolder + "\\images\\Datamine_rgb_small.png";
	 return true;
      }
   }
   catch(e) {
      alert("Failed\nReason: " + e.description);
      if ( oDmApp) oDmApp.Quit(); // release the session to close it down
   }
   return false;
}
function btnExecute_onclick()
{
	try	{


	;
    let input = document.forms["form1"]["name1"].value
    let output = document.forms["form1"]["outputfile"].value
    let wireframe = document.forms["form1"]["warstwa"].value
    let color = document.forms["form1"]["color"].value
    var outTR = output+"TR"
    var outPT = output+"PT"
    var command1 = "mgsort &IN="+input+" &OUT=holes1test *KEY1=BHID *KEY2=ZSTART @ORDER=2 @KEYSFRST=1 @ROWORDER=1 @KEYTOL=0.00001"
    var command2 = "picrec &IN=holes1test &OUT=hminus1test @APPEND=0 {ZONE >"+wireframe+"}"
    var command3 = "wftrend &POINTIN=hstart2test &WIRETR="+outTR+" &WIREPT="+outPT+" *XPT=XSTART *YPT=YSTART *ZPT=ZSTART @EXTN=200 @GRIDINC=100 @COLOURTR=0 @COLOUR1="+color+" "
	oDmApp.ParseCommand(command1);
	oDmApp.ParseCommand(command2+
	 " 'END'");
	oDmApp.ParseCommand("extra &IN=hminus1test &OUT=top2test1 @APPROX=0 @PRINT=0"+
	 "'TEST = 0'"+
	 "'IF (BHID!=prev(BHID))'"+
	 "'   TEST = 1'"+
	 "'END'"+"'GO'")
	 oDmApp.ParseCommand("picrec &IN=top2test1 &OUT=hstart2test @APPEND=0 {TEST = 1}"+
	 " 'END'");
	oDmApp.ParseCommand(command3);


	}
	catch(e) {
		alert("Failed\nReason: " + e.description);
	}
}
function btnHelp_onclick()
{
    let x = document.getElementById("help")
    a = a +1
    if (a%2==1){
        x.style.color = "#000000"
    }
    else{
        x.style.color = "#edffef"
    }
	// var features = "status=no,toolbar=no,menubar=no,location=no,scrollbars=yes,resizable=yes";
    //     var common = "_blank"
	// var installpath = oDmApp.Options.HelpFolder;
	// installpath = installpath.replace(" ", "%20");
	// var helpcommand = "mk:@MSITStore:" + installpath + "/DatamineStudio.chm::/Studio_3_General/Concept_Studio%203%20Scripting%20Overview.htm";
	// window.open(helpcommand, common, features);
}

</SCRIPT>
</HEAD>
<BODY onload="AutoConnect();" onunload="oDmApp = null;oScript = null;">
<div align="center">
<table border="0" cellpadding="5" cellspacing="0">
<tr>
<td><img src="C:/Program Files/Datamine/StudioRM//html/images/Datamine_rgb_small.png" id="logo" alt="Datamine" width="170" height="39" /></td>
</tr>
<tr>
<td align="center" colspan="2"></td>
</tr>
<tr>
<td align="center" colspan="2">
<input type="button" value="Execute" id="btnExecute" name="btnExecute" onclick="return btnExecute_onclick()" />
<input type="button" value="Help" id="btnHelp" name="btnHelp" onclick="return btnHelp_onclick()" />
</td>
</tr>
</table>
</div>
<div id = "header" align="center">
    <h1>Tworzenie powierzchni stropu warstw</h1>
</div>
<div id = "input" align="center">
    <form id = "form1" method="post" onsubmit="xd()">
        <label for ="name1">Podaj nazwę pliku odwiertów:</label>
        <br>
        <br>
        <input type = "text" id = "name1">
        <br>
        <br>
        <label for ="warstwa">Podaj numer warstwy:</label>
        <br>
        <br>
        <input type ="number" id = "warstwa">
        <br>
        <br>
        <label for ="outputfile">Nazwa pliku wyjściowego:</label>
        <br>
        <br>
        <input type="text" id="outputfile">
        <br>
        <br>
        <label for ="color">Kolor stropu (1-64):</label>
        <br>
        <br>
        <input type="text" id="color">
    </form>
</div>
<div id="help">
    <h3>HELP Menu</h3>
    <ol id="helptext">
        <li>
            Plik wejściowy (tekst) - plik zawierający dane próbek w odwiertach takie jak numer warstwy,współrzędne X,Y,Z i inne parametry odwiertu.
        </li>
        <li>
            Numer warstwy (liczba naturalna) - numer warstwy, dla której sporządzony ma być model stropu.
        </li>
        <li>
            Plik wyjściowy (tekst) - nazwa pliku, pod którą zostanie zapisany model triangulacji stropu warstwy w postacji plików TR i PT.
        </li>
        <li>
            Kod koloru (liczba naturalna [1:64]) - kolor powierzchni stropu.
        </li>
    </ol>
</div>
</BODY>
</HTML>
